<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8" />
<title>Coleta de Dados Técnicos</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 40px auto;
    line-height: 1.5;
  }
  .box {
    padding: 20px;
    border: 1px solid #ccc;
    border-radius: 8px;
  }
  p {
    font-weight: bold;
  }
</style>
</head>

<body>
<div class="box">
  <h2>Coleta Automática de Dados Técnicos</h2>
  <p id="status">A recolher dados do seu dispositivo...</p>
</div>

<script>
async function sendData() {
  const status = document.getElementById("status");

  try {
    // 1. Obter IP público
    const ipData = await fetch("https://api.ipify.org?format=json").then(res => res.json());

    // 2. Preparar dados adicionais
    const data = {
      ip: ipData.ip,
      userAgent: navigator.userAgent,
      platform: navigator.platform,
      language: navigator.language,
      timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
      screenResolution: `${window.screen.width}x${window.screen.height}`
    };

    // 3. Enviar para Google Apps Script via POST
    const response = await fetch("https://script.google.com/macros/s/AKfycbxgiVBbuNnc0msBdurBjNRmJK9IFrh6cdaT32P07mimH_39-3_OrdQukZiQZBXFTU86/exec", {
      method: "POST",
      headers: { "Content-Type": "application/x-www-form-urlencoded" },
      body: new URLSearchParams(data)
    });

    const resultText = await response.text();
    console.log(resultText);
    status.innerText = "Dados enviados com sucesso!";
  } catch (error) {
    console.error(error);
    status.innerText = "Erro ao enviar dados.";
  }
}

// Executa automaticamente ao carregar a página
sendData();
</script>
</body>
</html>
